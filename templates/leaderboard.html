<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Leaderboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
</head>
<body>
  <div class="wrapper">
    <div class="container">
    <h1>üèÖ Leaderboard</h1>
    <!-- Minimal controls: collapsed filters and a subtle clear link so the leaderboard stays unobtrusive -->
    <details class="filters" style="margin-bottom:0.6em; font-size:0.95em;">
      <summary style="cursor:pointer;">Filters ‚ñæ</summary>
      <form method="GET" class="filter-form" style="display:flex;gap:0.5em;flex-wrap:wrap;margin-top:0.45em;align-items:center;">
        <input name="top" type="number" min="1" placeholder="Top" style="width:5em;padding:0.2em;" value="{{ filters.top or '' }}">
        <input name="min_score" type="number" min="0" placeholder="Min" style="width:5.5em;padding:0.2em;" value="{{ filters.min_score or '' }}">
        <select name="difficulty" style="width:7.2em;padding:0.2em;">
          <option value="" {% if not filters.difficulty %}selected{% endif %}>All</option>
          <option value="easy" {% if filters.difficulty == 'easy' %}selected{% endif %}>Easy</option>
          <option value="medium" {% if filters.difficulty == 'medium' %}selected{% endif %}>Medium</option>
          <option value="hard" {% if filters.difficulty == 'hard' %}selected{% endif %}>Hard</option>
        </select>
        <input name="name" type="text" placeholder="Name" style="width:8em;padding:0.2em;" value="{{ filters.name or '' }}">
        <button type="submit" style="padding:0.25em 0.45em;">Apply</button>
        <a href="{{ url_for('leaderboard_page') }}" style="padding:0.25em 0.45em;color:#555;text-decoration:none;border-radius:3px;">Reset</a>
      </form>
    </details>

    <div style="display:flex;gap:0.8em;align-items:center;margin-bottom:0.5em;">
      <a href="#" id="clear-btn" style="color:#b00;font-size:0.9em;text-decoration:underline;">Clear dashboard</a>
      <a href="{{ url_for('home') }}" style="margin-left:auto"><button style="padding:0.35em 0.55em;">Play Again</button></a>
    </div>

    {% if leaderboard %}
      <table>
        <tr>
          <th>Rank</th>
          <th>Name</th>
          <th>Difficulty</th>
          <th>Attempts</th>
          <th>Time (s)</th>
          <th>Score</th>
        </tr>
        {% for e in leaderboard %}
        <tr>
          <td>{{ e.rank }}</td>
          <td>{{ e.name }}</td>
          <td>{{ e.difficulty }}</td>
          <td>{{ e.attempts }}</td>
          <td>{{ e.time }}</td>
          <td>{{ e.score }}</td>
        </tr>
        {% endfor %}
      </table>
    {% else %}
      <p>No scores match the current filters. Be the first to play!</p>
    {% endif %}
    </div>
  </div>

  <footer style="text-align:center; margin-top:2em; color:#888; font-size:0.9em;">
    ¬© 2025 Akhil-28407 ‚Äî Designed by Akhil-28407
  </footer>

  <script>
    document.getElementById('clear-btn').addEventListener('click', function() {
      if (!confirm('Are you sure you want to clear the leaderboard? This cannot be undone.')) return;
  fetch('{{ url_for("leaderboard_clear") }}', { method: 'POST' })
        .then(function(res) {
          if (res.redirected) {
            window.location = res.url;
          } else if (res.ok) {
            window.location.reload();
          } else {
            alert('Failed to clear leaderboard');
          }
        })
        .catch(function() { alert('Network error while clearing leaderboard'); });
    });
  </script>
</body>
</html>
